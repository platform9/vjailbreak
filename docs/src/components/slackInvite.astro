---
import { Icon } from '@astrojs/starlight/components';
import '../styles/custom.css';
---

<div class="slack-invite">
  <!-- Social Icons Slot -->
  <slot />

  <!-- Slack Invite Button -->
  <button
    class="custom-icon-button"
    aria-label="Open Form"
    onclick="openModal()"
  >
    <Icon name="slack" style="--sl-icon-size: 1em;" fill="currentColor" color="var(--sl-color-text-accent)" />
  </button>

  <!-- Modal Overlay -->
  <div id="modal-overlay" class="modal-overlay">
    <div class="modal-container">
      <div class="modal-header">
        <h3>Slack Invite</h3>
        <button class="modal-close" onclick="closeModal()">Ã—</button>
      </div>
      <form
        action="https://docs.google.com/forms/u/0/d/e/1FAIpQLSel_cpjw-lfHSchLYE8KqLlcHC1reZdbb30-0J9R1xJECVzGw/formResponse"
        method="post"
        target="_blank"
      >
        <input
          autocomplete="email"
          name="emailAddress"
          placeholder="Your email"
          type="email"
          required
        />
        <button type="submit">Invite Me!</button>
      </form>
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function () {
      const modalOverlay = document.getElementById('modal-overlay');
  
      window.openModal = function () {
          modalOverlay.classList.add('active');
      };
  
      window.closeModal = function () {
          modalOverlay.classList.remove('active');
      };
  
      // Close modal on ESC key press
      document.addEventListener('keydown', function (event) {
          if (event.key === 'Escape' && modalOverlay.classList.contains('active')) {
              closeModal();
          }
      });
  });
  </script>